generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model WatchlistItem {
  id         String   @id(map: "WatchlistItem_pkey") @default(cuid())
  type       String
  title      String
  status     String   @default("PLAN_TO_WATCH")
  externalId String   @map("external_id")
  imageUrl   String?  @map("image_url")
  rating     Float?
  year       Int?
  episodes   Int?
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @updatedAt @map("updated_at")

  @@unique([externalId, type])
  @@index([type])
  @@index([status])
  @@index([createdAt])
  @@map("watchlist_items")
}

model StockQuote {
  symbol        String   @id(map: "stock_quotes_new_pkey")
  companyName   String?  @map("company_name")
  logoUrl       String?  @map("logo_url")
  currentPrice  Float    @map("current_price")
  change        Float
  percentChange Float    @map("percent_change")
  lastUpdated   DateTime @default(now()) @map("last_updated")
  updatedAt     DateTime @default(now()) @updatedAt @map("updated_at")

  @@index([lastUpdated])
  @@map("stock_quotes")
}

model DailyQuote {
  date      String   @id(map: "daily_quotes_new_pkey")
  content   String
  author    String
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at")

  @@map("daily_quotes")
}

model CryptoQuote {
  symbol           String   @id(map: "crypto_quotes_new_pkey")
  name             String
  logoUrl          String?  @map("logo_url")
  price            Float
  percentChange24h Float?   @map("percent_change_24h")
  lastUpdated      DateTime @default(now()) @map("last_updated")
  createdAt        DateTime @default(now()) @map("created_at")
  updatedAt        DateTime @default(now()) @updatedAt @map("updated_at")

  @@map("crypto_quotes")
}

model TopItem {
  id          String   @id
  type        String
  title       String
  imageUrl    String   @map("image_url")
  year        Int?
  rating      Float
  episodes    Int?
  externalId  Int      @map("external_id")
  lastUpdated DateTime @default(now()) @map("last_updated")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @default(now()) @updatedAt @map("updated_at")

  @@unique([externalId, type])
  @@index([type])
  @@index([lastUpdated])
  @@map("top_items")
}

model ApiUsage {
  id         String   @id @default(cuid())
  apiName    String   @map("api_name")
  endpoint   String?
  timestamp  DateTime @default(now())
  success    Boolean  @default(true)
  statusCode Int?     @map("status_code")
  createdAt  DateTime @default(now()) @map("created_at")

  @@index([apiName, timestamp])
  @@index([timestamp])
  @@map("api_usage")
}

model GameScore {
  id            String    @id @default(cuid())
  gameId        String    @map("game_id")
  sport         String
  date          DateTime  @db.Date
  homeTeam      String    @map("home_team")
  awayTeam      String    @map("away_team")
  homeScore     Int       @map("home_score")
  awayScore     Int       @map("away_score")
  homeTeamLogo  String?   @map("home_team_logo")
  awayTeamLogo  String?   @map("away_team_logo")
  status        String
  quarter       String?
  timeRemaining String?   @map("time_remaining")
  startTime     DateTime  @map("start_time")
  playoffRound  String?   @map("playoff_round")
  odds          Json?
  topScorer     Json?     @map("top_scorer")
  expiresAt     DateTime? @map("expires_at")
  lastUpdated   DateTime  @default(now()) @map("last_updated")
  createdAt     DateTime  @default(now()) @map("created_at")
  updatedAt     DateTime  @default(now()) @updatedAt @map("updated_at")

  @@unique([gameId, sport, date])
  @@index([sport, date])
  @@index([sport, status])
  @@index([status, expiresAt])
  @@index([lastUpdated])
  @@map("game_scores")
}

model TopPerformer {
  id          String   @id @default(cuid())
  sport       String
  date        DateTime @db.Date
  name        String
  team        String
  imageUrl    String?  @map("image_url")
  stats       Json
  lastUpdated DateTime @default(now()) @map("last_updated")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@unique([sport, date, name])
  @@index([sport, date])
  @@index([lastUpdated])
  @@index([sport, lastUpdated])
  @@map("top_performers")
}

model Note {
  id        String   @id @default(cuid())
  title     String
  content   String
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")
  tasks     Task[]

  @@index([createdAt])
  @@map("notes")
}

model Task {
  id          String    @id @default(cuid())
  title       String
  description String?
  status      String    @default("TODO")
  priority    String    @default("MEDIUM")
  dueDate     DateTime? @map("due_date") @db.Date
  category    String?
  notes       String?
  noteId      String?   @map("note_id")
  position    Int       @default(0)
  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")
  note        Note?     @relation(fields: [noteId], references: [id])

  @@index([status])
  @@index([status, position])
  @@index([category])
  @@index([priority])
  @@index([dueDate])
  @@index([createdAt])
  @@map("tasks")
}

model Game {
  id          String   @id @default(cuid())
  gameTitle   String   @map("game_title")
  rawgRating  Float?   @map("rawg_rating")
  coverArtUrl String?  @map("cover_art_url")
  status      String   @default("PLAYLIST") // 'PLAYING' | 'PLAYED' | 'PLAYLIST'
  rawgGameId  Int      @unique @map("rawg_game_id")
  releaseDate String?  @map("release_date")
  genres      String?
  platforms   String?
  metacritic  Int?
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@index([status])
  @@index([createdAt])
  @@index([status, createdAt])
  @@map("games")
}
